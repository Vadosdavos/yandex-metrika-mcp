# MCP Сервер для Яндекс.Метрики (Node.js)

Сервер Model Context Protocol (MCP), который предоставляет доступ к данным аналитики Яндекс.Метрики через различные инструменты и функции. Этот сервер позволяет ИИ-ассистентам и приложениям получать комплексные аналитические данные из аккаунтов Яндекс.Метрики.

## Возможности

- **Информация об аккаунте**: Получение основной информации об аккаунте и счетчиках
- **Аналитика трафика**: Получение данных о посещениях, просмотрах страниц и метриках вовлеченности пользователей
- **Источники трафика**: Анализ источников трафика, включая органический поиск, прямой трафик и рефералы
- **Аналитика контента**: Получение данных о производительности статей, авторов, категорий и тем
- **Демография пользователей**: Доступ к демографическим данным пользователей и анализу устройств
- **Географические данные**: Анализ регионального трафика и географическое распределение
- **E-commerce аналитика**: Отслеживание производительности продуктов и доходов
- **Отслеживание конверсий**: Коэффициенты конверсии целей и анализ воронки
- **Производительность поиска**: Органические поисковые запросы и данные поисковых систем
- **Анализ устройств**: Сравнение мобильного и десктопного трафика

## Установка

```bash
  "mcpServers": {
    "yandex-metrika-mcp": {
      "command": "node",
      "args": [
        "{path-to-repo}/build/index.js"
      ],
      "env": {
        "YANDEX_API_KEY": {your_yandex_api_key_here}
      }
    }
  }
```

## Получение авторизационного токена

Чтобы получить авторизационный токен:

1.  [**Создайте приложение**](https://oauth.yandex.ru/client/new), при этом заполните поля:
    *   **название** — можно указать произвольно;
    *   **иконка сервиса** — необязательно;
    *   **платформы приложения** — выберите **веб-сервисы**;
    *   **redirect URI** — укажите `https://oauth.yandex.ru/verification_code`;
    *   **доступ к данным** — укажите набор доступов для вашего приложения. Какие бывают доступы:
        *   `metrika:read` — получение статистики, чтение параметров своих и доверенных счетчиков, получение списка счетчиков;
        *   `metrika:write` — создание счетчиков, изменение параметров своих и доверенных счетчиков, загрузка любых данных;
        *   `metrika:expenses` — загрузка в счетчики расходов;
        *   `metrika:user_params` — загрузка в счетчики параметров пользователей;
        *   `metrika:offline_data` — загрузка в счетчики офлайн-данных (данные из CRM, офлайн-конверсии, звонки).

    *Примечание: Доступы `metrika:expenses`, `metrika:user_params`, `metrika:offline_data` не обязательны, если используется доступ `metrika:write`.*

2.  Нажмите **Создать приложение** и скопируйте его ClientID (напротив идентификатора нажмите значок ).

3.  Добавьте скопированный ClientID в ссылку вида:
    `https://oauth.yandex.ru/authorize?response_type=token&client_id=<application_id>`

4.  Перейдите по ссылке и на открывшейся странице скопируйте ваш авторизационный токен.

## Доступные инструменты

Сервер предоставляет 25 различных инструментов для доступа к данным Яндекс.Метрики:

### Аккаунт и базовая аналитика
- `get_account_info` - Получение основной информации об аккаунте и счетчиках Яндекс.Метрики
- `get_visits` - Получение статистики посещений с возможностью фильтрации по датам (по умолчанию за последние 7 дней)

### Анализ источников трафика
- `sources_summary` - Получение комплексного обзора и сводного отчета по источникам трафика
- `sources_search_phrases` - Получение поисковых фраз и информации о браузерах из источников трафика
- `get_traffic_sources_types` - Анализ различных типов источников трафика (органический, прямой, реферальный)
- `get_search_engines_data` - Получение данных о сессиях и пользователях из поисковых систем с опциональными фильтрами
- `get_new_users_by_source` - Определение наиболее эффективных источников трафика для привлечения новых пользователей

### Аналитика контента
- `get_content_analytics_sources` - Получение источников, которые приводят пользователей к статьям на сайте
- `get_content_analytics_categories` - Получение общей статистики по категориям контента
- `get_content_analytics_authors` - Получение статистики по производительности авторов статей
- `get_content_analytics_topics` - Анализ производительности по темам статей
- `get_content_analytics_articles` - Получение детального отчета о просмотрах статей, сгруппированного по статьям

### Поведение пользователей и демография
- `get_user_demographics` - Доступ к демографическим данным пользователей и вовлеченности по категориям устройств
- `get_device_analysis` - Анализ поведения пользователей по браузерам и операционным системам
- `get_mobile_vs_desktop` - Сравнение метрик трафика и вовлеченности между мобильными и десктопными пользователями
- `get_page_depth_analysis` - Получение сессий, где пользователи просмотрели более указанного количества страниц

### Географические и региональные данные
- `get_regional_data` - Получение данных о сессиях и пользователях для конкретных регионов/городов
- `get_geographical_organic_traffic` - Анализ географического распределения органического трафика

### Производительность и конверсия
- `get_page_performance` - Получение производительности страниц и показателя отказов по URL-путям
- `get_goals_conversion` - Отслеживание коэффициентов конверсии для указанных целей
- `get_organic_search_performance` - Анализ производительности органического поиска по поисковым системам и запросам

### E-commerce аналитика
- `get_ecommerce_performance` - Получение производительности e-commerce по категориям продуктов и регионам

### Браузеры и технические данные
- `get_browsers_report` - Получение отчета по браузерам без учета версии браузера

### Расширенная аналитика
- `get_data_by_time` - Получение данных за определенные периоды времени, сгруппированных по дням, неделям, месяцам, кварталам или годам
- `get_yandex_direct_experiment` - Получение показателя отказов для конкретных экспериментов Яндекс.Директ

## Требования

- Node.js 18+
- API токен доступа к Яндекс.Метрике

## Лицензия

MIT
